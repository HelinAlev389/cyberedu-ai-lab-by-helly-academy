{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <div class="card p-4 shadow-sm rounded-4">
    <h2>{{ title }}</h2>
    <hr>
    <p>{{ content }}</p>

    <form class="mb-3">
  <select name="lesson_id" class="form-select"
          onchange="this.form.submit()">
    {% for lid in available_lessons %}
      <option value="{{ lid }}" {{ 'selected' if lid == current_id else '' }}>
        {{ lid }}
      </option>
    {% endfor %}
  </select>
</form>


    {# --- –ê–∫–æ —Ç–∞–∑–∏ —Å—Ç—ä–ø–∫–∞ –æ—á–∞–∫–≤–∞ –≤—Ö–æ–¥ -- #}
    {% if expect_input %}
      <form method="POST" class="mt-3">
        <div class="mb-3">
          <textarea class="form-control" name="user_answer" rows="4"
                    placeholder="–¢–≤–æ—è—Ç –æ—Ç–≥–æ–≤–æ—Ä..." required>{{ prev_answer|default("") }}</textarea>
        </div>
        <button class="btn btn-success" name="action" value="submit_answer">–ò–∑–ø—Ä–∞—Ç–∏ –æ—Ç–≥–æ–≤–æ—Ä</button>
        <button class="btn btn-secondary" name="action" value="skip">–ü—Ä–µ—Å–∫–æ—á–∏</button>
      </form>
    {% else %}
      <form method="POST" class="d-flex gap-2 mt-3">
        <button class="btn btn-secondary" name="action" value="back">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
        <button class="btn btn-primary" name="action" value="next">‚û°Ô∏è –°–ª–µ–¥–≤–∞—â</button>
        <button class="btn btn-warning" name="action" value="restart">üîÑ –†–µ—Å—Ç–∞—Ä—Ç</button>
      </form>
    {% endif %}

    # --- –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ AI feedback, –∞–∫–æ –∏–º–∞ -- #
    {% if feedback %}
      <div class="alert alert-info mt-4">
        <strong>AI Feedback:</strong><br>
        {{ feedback }}
      </div>
      <form method="POST">
        <button class="btn btn-primary" name="action" value="next">‚û°Ô∏è –°–ª–µ–¥–≤–∞—â</button>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
