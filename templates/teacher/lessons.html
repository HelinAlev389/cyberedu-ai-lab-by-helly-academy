{% extends "base.html" %}
{% block content %}

{% set topic_styles = {
  'Cybersecurity': {'color': 'danger', 'icon': 'ğŸ”'},
  'Networking': {'color': 'primary', 'icon': 'ğŸŒ'},
  'Linux': {'color': 'dark', 'icon': 'ğŸ§'},
  'Forensics': {'color': 'info', 'icon': 'ğŸ•µï¸â€â™‚ï¸'},
  'Web': {'color': 'warning', 'icon': 'ğŸŒ'},
  'AI': {'color': 'success', 'icon': 'ğŸ¤–'}
} %}

<h2 class="mt-4">ğŸ“š Ğ¡ÑŠĞ·Ğ´Ğ°Ğ¹ Ğ½Ğ¾Ğ² ÑƒÑ€Ğ¾Ğº</h2>
<form method="POST" class="mt-3">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  {{ form.hidden_tag() }}
  <div class="mb-3">
    {{ form.title.label(class="form-label") }}
    {{ form.title(class="form-control") }}
  </div>
  <div class="mb-3">
    {{ form.topic.label(class="form-label") }}
    {{ form.topic(class="form-select") }}
  </div>
  <div class="mb-3">
    {{ form.content.label(class="form-label") }}
    {{ form.content(class="form-control", rows=5) }}
    <div class="form-text">ĞœĞ¾Ğ¶ĞµÑˆ Ğ´Ğ° Ğ¸Ğ·Ğ¿Ğ¾Ğ»Ğ·Ğ²Ğ°Ñˆ Markdown Ğ¸Ğ»Ğ¸ HTML</div>
  </div>
  <button type="submit" class="btn btn-primary">ğŸ’¾ Ğ¡ÑŠĞ·Ğ´Ğ°Ğ¹ ÑƒÑ€Ğ¾Ğº</button>
</form>

<hr class="my-4">

<h3>Ğ¡ÑŠÑ‰ĞµÑÑ‚Ğ²ÑƒĞ²Ğ°Ñ‰Ğ¸ ÑƒÑ€Ğ¾Ñ†Ğ¸</h3>

{% if lessons %}
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mt-3">
    {% for lesson in lessons %}
      <div class="col">
        <div class="card h-100 shadow-sm border border-{{ topic_styles.get(lesson.topic, {}).get('color', 'secondary') }}">
          <div class="card-body">
            <h5 class="card-title">{{ lesson.title }}</h5>
            <p class="card-text text-muted">
              <span class="badge bg-{{ topic_styles.get(lesson.topic, {}).get('color', 'secondary') }}">
                {{ topic_styles.get(lesson.topic, {}).get('icon', 'ğŸ“˜') }} {{ lesson.topic }}
              </span>
            </p>
            <div class="d-flex justify-content-between mt-3">
              <a href="{{ url_for('teacher_dashboard.view_lesson', lesson_id=lesson.id) }}" class="btn btn-sm btn-outline-primary">ğŸ‘ï¸</a>
              <a href="{{ url_for('teacher_dashboard.edit_lesson', lesson_id=lesson.id) }}" class="btn btn-sm btn-outline-warning">âœï¸</a>
              <form method="POST" action="{{ url_for('teacher_dashboard.delete_lesson', lesson_id=lesson.id) }}" style="display:inline;" onsubmit="return confirm('ĞĞ°Ğ¸ÑÑ‚Ğ¸Ğ½Ğ° Ğ»Ğ¸ Ğ¸ÑĞºĞ°Ñˆ Ğ´Ğ° Ğ¸Ğ·Ñ‚Ñ€Ğ¸ĞµÑˆ Ñ‚Ğ¾Ğ·Ğ¸ ÑƒÑ€Ğ¾Ğº?');">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <button type="submit" class="btn btn-sm btn-outline-danger">ğŸ—‘ï¸</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">â— Ğ’ÑĞµ Ğ¾Ñ‰Ğµ Ğ½ÑĞ¼Ğ° ÑÑŠĞ·Ğ´Ğ°Ğ´ĞµĞ½Ğ¸ ÑƒÑ€Ğ¾Ñ†Ğ¸.</p>
{% endif %}

<!-- Markdown Editor -->
<script>
  const editor = new EasyMDE({
    element: document.querySelector('textarea[name="content"]'),
    imageUpload: true,
    imagePath: "/uploads/",
    uploadImage: true,
    toolbar: ["bold", "italic", "heading", "|", "quote", "unordered-list", "ordered-list", "|", "link", "image", "preview", "guide"]
  });
</script>

{% endblock %}
