MISSIONS = {
    "CTF-SOC-001": {
        "title": "Подозрително PowerShell изпълнение",
        "log_file": "powershell_suspicious.json",
        "tiers": {
            "1": {
                "description": "Прегледай алармата, потвърди дали е фалшива, идентифицирай основни IOC.",
                "questions": [
                    "Какво е алармирало SIEM системата?",
                    "Има ли нещо съмнително в командата?",
                    "Кои са 2 основни IOC?",
                    "Скриптът стартира ли мрежови команди?",
                    "Има ли индикатор за кодиране или скриптиране?"
                ]
            },
            "2": {
                "description": "Декодирай PowerShell командата и идентифицирай зловредната активност.",
                "questions": [
                    "Какво е декодираното съдържание?",
                    "Какъв е типът на атаката?",
                    "Има ли следи от връзка с външен сървър?",
                    "Откриваш ли втора фаза на атаката?",
                    "Сравни поведението с MITRE ATT&CK техника."
                ]
            },
            "3": {
                "description": "Извърши лов на заплахи и предложи правила за засичане.",
                "questions": [
                    "Какви са повтарящите се артефакти в атаката?",
                    "Предложи YARA или логическо правило за засичане.",
                    "Каква е възможна мярка на SIEM/EDR ниво?",
                    "Как да се провери дали атаката е успешна?",
                    "Предполагаема цел или мотивация на атаката?"
                ]
            }
        }
    },
    "CTF-SOC-002": {
        "title": "Brute Force Атака по пароли",
        "log_file": "brute_force_attempts.json",
        "tiers": {
            "1": {
                "description": "Разгледай failed logins и посочи дали има аномалия.",
                "questions": [
                    "Колко неуспешни логина има от IP 192.168.1.50?",
                    "Кой потребител е цел на опитите?",
                    "Има ли успешен вход след неуспехите?",
                    "Кой е времевият интервал между опитите?",
                    "Какъв е използваният протокол – SSH, RDP или друг?"
                ]
            },
            "2": {
                "description": "Анализирай атакуващото поведение и създай времева линия.",
                "questions": [
                    "Каква е времевата рамка на атаката?",
                    "Какъв тип brute force е използван – slow или fast?",
                    "Има ли други IP-та със сходно поведение?",
                    "Колко различни usernames са опитани?",
                    "Има ли смяна на IP адрес след блок?"
                ]
            },
            "3": {
                "description": "Разшири анализа и предложи защитна мярка в мрежата и SIEM.",
                "questions": [
                    "Създай условие за засичане в SIEM (напр. Sigma, KQL).",
                    "Какво firewall правило би приложил?",
                    "Какво действие да се предприеме за засегнатия акаунт?",
                    "Как можеш да използваш GeoIP за разследване?",
                    "Какво е поведението след успешно влизане?"
                ]
            }
        }
    },
    "CTF-SOC-003": {
        "title": "Аномален DNS трафик към C2 сървър",
        "log_file": "dns_beaconing.json",
        "tiers": {
            "1": {
                "description": "Прегледай DNS заявки и посочи необичаен домейн.",
                "questions": [
                    "Кой домейн изглежда съмнителен?",
                    "Колко пъти е заявен за 15 минути?",
                    "От коя машина идват заявките?",
                    "Има ли специфичен времеви интервал между заявките?",
                    "Какъв е TTL (time to live) на DNS записите?"
                ]
            },
            "2": {
                "description": "Анализирай DNS beaconing модел и свързани външни IP-та.",
                "questions": [
                    "Какъв е честотният модел на beaconing?",
                    "Има ли HTTP връзка след DNS lookup?",
                    "Можем ли да изведем IOC от поведението?",
                    "Каква е продължителността на активността?",
                    "Какво поведение показват другите хостове?"
                ]
            },
            "3": {
                "description": "Предложи начин за засичане и защита от подобни beacon-и.",
                "questions": [
                    "Каква е мрежова сигнатура или поведение на C2 beacon?",
                    "Създай SIEM правило за DNS анализ.",
                    "Какъв тип мрежов контрол би блокирал връзката?",
                    "Какво да се направи с домейна – блок, sinkhole или друго?",
                    "Как да валидираме дали машината е компрометирана?"
                ]
            }
        }
    },
    "CTF-SOC-004": {
        "title": "Red vs Blue: Вътрешна компрометация",
        "log_file": "red_vs_blue_activity.json",
        "tiers": {
            "1": {
                "description": "Прегледай действията на Red Team. Как е постигнат първоначалният достъп?",
                "questions": [
                    "Кой потребител е бил компрометиран първи?",
                    "Какво средство за достъп е използвано от Red Team?",
                    "Има ли индикатори за експлоит или phishing?"
                ]
            },
            "2": {
                "description": "Анализирай как е ескалирана атаката и кои системи са засегнати.",
                "questions": [
                    "Какви права са получени от атакуващия?",
                    "Има ли lateral movement – ако да, към кои машини?",
                    "Какъв тип команди са изпълнени в целевата мрежа?"
                ]
            },
            "3": {
                "description": "Blue Team трябва да предложи действия за защита и инцидентна реакция.",
                "questions": [
                    "Кое е най-силното доказателство за атака в логовете?",
                    "Какви мерки трябва да предприеме Blue Team веднага?",
                    "Създай SIEM правило за засичане на подобна компрометация."
                ]
            }
        }
    },
    "CTF-SOC-005": {
        "title": "Silent Hydra: Целева атака с множество фази",
        "log_file": "silent_hydra_attack.json",
        "tiers": {
            "1": {
                "description": "Идентифицирай първоначалната векторна атака и поведението на потребителя.",
                "questions": [
                    "Кой потребител първи отваря зловредния линк?",
                    "Какъв е URL адресът, който е достъпен?",
                    "Има ли файл, свален от URL-а и какъв е неговият формат?",
                    "Как реагира антивирусната система?"
                ]
            },
            "2": {
                "description": "Анализирай процесите след компрометиране и lateral movement-а.",
                "questions": [
                    "Какво стартира потребителят след свалянето на файла?",
                    "Какви процеси или скриптове се създават?",
                    "Има ли достъп до други машини?",
                    "Какво показват логовете за вътрешна комуникация?"
                ]
            },
            "3": {
                "description": "Определи поведението на атакуващия и предложи защита и засичане.",
                "questions": [
                    "Какво е поведението на exfiltration/комуникация с външен хост?",
                    "Има ли индикации за credential dumping?",
                    "Предложи начин за блокиране на подобен тип атака на ниво мрежа и крайна точка.",
                    "Създай базово Sigma правило или KQL заявка за засичане."
                ]
            }
        }
    }

}
