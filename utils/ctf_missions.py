from flask import render_template

MISSIONS = {
    "CTF-SOC-001": {
        "title": "Подозрително PowerShell изпълнение",
        "tiers": {
            "1": {
                "description": "Прегледай алармата, потвърди дали е фалшива, идентифицирай основни IOC.",
                "questions": [
                    "Какво е алармирало SIEM системата?",
                    "Има ли нещо съмнително в командата?",
                    "Кои са 2 основни IOC?"
                ]
            },
            "2": {
                "description": "Декодирай PowerShell командата и идентифицирай зловредната активност.",
                "questions": [
                    "Какво е декодираното съдържание?",
                    "Какъв е типът на атаката?",
                    "Има ли следи от връзка с външен сървър?"
                ]
            },
            "3": {
                "description": "Извърши лов на заплахи и предложи правила за засичане.",
                "questions": [
                    "Какви са повтарящите се артефакти в атаката?",
                    "Предложи YARA или логическо правило за засичане.",
                    "Каква е възможна мярка на SIEM/EDR ниво?"
                ]
            }
        }
    },
    "CTF-SOC-002": {
        "title": "Brute Force Атака по пароли",
        "tiers": {
            "1": {
                "description": "Разгледай failed logins и посочи дали има аномалия.",
                "questions": [
                    "Колко неуспешни логина има от IP 192.168.1.50?",
                    "Кой потребител е цел на опитите?",
                    "Има ли успешен вход след неуспехите?"
                ]
            },
            "2": {
                "description": "Анализирай атакуващото поведение и създай времева линия.",
                "questions": [
                    "Каква е времевата рамка на атаката?",
                    "Какъв тип brute force е използван – slow или fast?",
                    "Има ли други IP-та със сходно поведение?"
                ]
            },
            "3": {
                "description": "Разшири анализа и предложи защитна мярка в мрежата и SIEM.",
                "questions": [
                    "Създай условие за засичане в SIEM (напр. Sigma, KQL).",
                    "Какво firewall правило би приложил?",
                    "Какво действие да се предприеме за засегнатия акаунт?"
                ]
            }
        }
    },
    "CTF-SOC-003": {
        "title": "Аномален DNS трафик към C2 сървър",
        "tiers": {
            "1": {
                "description": "Прегледай DNS заявки и посочи необичаен домейн.",
                "questions": [
                    "Кой домейн изглежда съмнителен?",
                    "Колко пъти е заявен за 15 минути?",
                    "От коя машина идват заявките?"
                ]
            },
            "2": {
                "description": "Анализирай DNS beaconing модел и свързани външни IP-та.",
                "questions": [
                    "Какъв е честотният модел на beaconing?",
                    "Има ли HTTP връзка след DNS lookup?",
                    "Можем ли да изведем IOC от поведението?"
                ]
            },
            "3": {
                "description": "Предложи начин за засичане и защита от подобни beacon-и.",
                "questions": [
                    "Каква е мрежова сигнатура или поведение на C2 beacon?",
                    "Създай SIEM правило за DNS анализ.",
                    "Какъв тип мрежов контрол би блокирал връзката?"
                ]
            }
        }
    }
}

